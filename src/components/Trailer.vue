<script setup lang="ts">
import { ref, onMounted, onUnmounted } from "vue";
import Custom from "../components/buttons/Custom.vue";
import type { Show } from "../types/auth";

const props = defineProps({
  items: {
    type: Array as () => Show[],
    required: true,
  },
});

const current = ref(0);
let interval: number | undefined;

onMounted(() => {
  interval = window.setInterval(() => {
    current.value = (current.value + 1) % props.items.length;
  }, 5000);
});

onUnmounted(() => {
  if (interval) clearInterval(interval);
});
</script>

<template>
  <div
    class="trailer-container position-relative overflow-hidden d-flex text-start align-items-start justify-content-start"
    v-if="items && items.length"
  >
    <Transition name="slide-fade" mode="out-in">
      <div
        :key="items[current]?.title"
        class="trailer-slide position-relative w-100 h-100"
      >
        <div
          class="trailer-bg position-absolute top-0 start-0 w-100 h-100 bg-cover bg-center z-1"
          :style="{
            backgroundImage: `url(${
              items[current]?.thumbnail ?? './screen.png'
            })`,
          }"
        ></div>
        <div class="trailer-content position-relative z-2 py-5 px-5">
          <h1 class="trailer-title fw-bold mb-4">
            {{ items[current]?.title }}
          </h1>
          <p class="trailer-desc mb-4">{{ items[current]?.description }}</p>
          <div
            class="trailer-actions d-flex gap-3 align-items-center justify-content-start"
          >
            <Custom label="Save" type="success" :leftIcon="'bi bi-save'" />
            <Custom label="Info" type="secondary" :leftIcon="'bi bi-info-square'" />
          </div>
        </div>
      </div>
    </Transition>
  </div>
</template>

<style scoped>
.trailer-container {
  height: 100%;
  background: linear-gradient(to right top, var(--black), var(--green-1));
}

.trailer-bg {
  filter: brightness(0.6);
  background-repeat: no-repeat !important;
  background-size: cover !important;
  background-position: center !important;
}

.trailer-content {
  color: var(--white);
  max-width: 600px;
  margin-top: 5rem;
  margin-left: 2rem;
}

.trailer-title {
  font-size: 5rem;
}

.trailer-desc {
  font-size: 1.2rem;
}

.slide-fade-enter-active,
.slide-fade-leave-active {
  transition: all 0.25s cubic-bezier(0.55, 0, 0.1, 1);
  position: absolute;
  width: 100%;
}

.slide-fade-enter-from {
  opacity: 0;
  transform: translateX(100%);
}

.slide-fade-leave-to {
  opacity: 0;
  transform: translateX(-100%);
}

.slide-fade-enter-to,
.slide-fade-leave-from {
  opacity: 1;
  transform: translateX(0);
}
</style>
